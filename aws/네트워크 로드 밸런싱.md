# 네트워크 로드밸런싱

**로드 밸런싱(Load Balancing)**
서버에 가해지는 부하를 분산시켜주는 장치 또는 기술


## 서버 로드 밸런싱
외부로부터의 요청을 서버가 직접 받지 않고 장치 또는 소프트웨어가 받아서 나누어준다.
*L4/L7 Switch(Layer4)* 또는 클라우드에서는 *Load Balancer*라고 부른다.

클라우드에서 스케일업(성능향상), 스케일아웃(서버 개수 증가)에서 스케일 아웃 방식은 여러 대의 서버로 트래픽을 분산시켜주는 로드밸런싱이 반드시 필요하다 


## 로드 밸런싱 알고리즘
*라운드로빈*
서버에 들어온 요청을 순서대로 돌아가며 배정하는 가장 단순한 방법
서버와의 연결이 오래 지속되지 않을 경우 적합

*최소 연결*
요청이 들어온 시점에 가장 적은 연결 상태(Connection)를 가진 서버에 트래픽을 배정
서버에 분배된 트래픽이 일정하지 않은 경우 적합

*가중 라운드로빈*
서버의 처리 능력을 고려하여 각 서버의 Connection 비율을 미리 정해둔다
각 서버에 가중치를 매기고 가중치가 높은 서버에 우선 배정

*응답 시간*
응답 속도가 가장 빠른 서버에게 우선적으로 할당

*IP 해시*
클라이언트 IP 주소를 특정 서버로 매핑하여 요청 처리
사용자가 동일한 서버로 연결됨


## L4/L7 로드 밸런싱 개요
*L4 로드 밸런싱*
- 트랜스포트 계층에서 IP와 포트를 확용하여 로드 분산
- TCP, UDP 포트 정보 바탕
- 속도가 빠르고 효율이 높음(패킷 레벨에서 로드를 분산)
- 섬세한 라우팅 어렵지만 저렴

*L7 로드 밸런싱*
- 어플리케이션 계층에서 헤더를 분석하여 로드 분산
- HTTP 헤더, 쿠키 등과 같은 사용자 요청 기준으로 특정 서버에 트래픽 분산 가능
- 패킷 내용을 확인 하고 내용에 따라 특정 서버에 분배 가능
- 섬세한 라우팅, 비정상적인 트래픽을 필터링 가능
- 패킷 내용의 복호화로 더 많은 비용 발생


